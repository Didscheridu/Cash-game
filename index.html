<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Imperium: Ultimate Collection</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-panel: #1e1e1e;
            --accent: #FFD700;
            --green: #00e676;
            --red: #ff5252;
            --blue: #2979ff;
            --purple: #d500f9;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-dark);
            color: white;
            margin: 0;
            padding: 0;
            text-align: center;
            user-select: none;
        }

        /* --- HAUPTMEN√ú --- */
        #mainMenu {
            display: flex; flex-direction: column; align-items: center; justify-content: start;
            min-height: 100vh; padding: 40px 20px;
            background: radial-gradient(circle at top, #2c2c2c 0%, #000000 100%);
        }
        .menu-title { font-size: 3em; margin-bottom: 10px; color: var(--accent); text-transform: uppercase; letter-spacing: 3px; }
        .menu-cash { font-size: 2.5em; margin-bottom: 40px; color: var(--green); font-weight: bold; text-shadow: 0 0 10px rgba(0,230,118,0.3); }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }
        .menu-card {
            background: var(--bg-panel); padding: 30px; border-radius: 15px; border: 2px solid #333;
            cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center;
        }
        .menu-card:hover { transform: translateY(-5px); border-color: var(--accent); background: #252525; }
        .card-icon { font-size: 3.5em; margin-bottom: 15px; }
        .card-title { font-size: 1.4em; font-weight: bold; margin-bottom: 5px; }
        .card-desc { color: #888; font-size: 0.9em; }

        /* --- GAME VIEWS --- */
        .game-view { display: none; height: 100vh; box-sizing: border-box; padding: 20px; max-width: 1000px; margin: 0 auto; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; background: #333; padding: 10px 20px; border-radius: 10px; margin-bottom: 20px; }
        .back-btn { background: #555; color: white; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .back-btn:hover { background: #777; }
        
        button { cursor: pointer; border: none; transition: 0.2s; }
        button:active { transform: scale(0.95); }

        /* --- STYLES: FREELANCER --- */
        .project-card { background: var(--bg-panel); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #444; }
        .progress-container { width: 100%; background: #333; height: 30px; border-radius: 15px; margin: 15px 0; overflow: hidden; position: relative;}
        .progress-bar { height: 100%; background: var(--blue); width: 0%; transition: width 0.1s linear; }
        .code-btn { width: 100%; padding: 20px; font-size: 1.5em; background: var(--blue); color: white; border-radius: 10px; font-family: monospace; }

        /* --- STYLES: SAFE --- */
        .safe-box { background: #222; padding: 40px; border-radius: 20px; border: 5px solid #444; position: relative; max-width: 500px; margin: 0 auto; }
        .safe-display { background: black; color: red; font-family: monospace; font-size: 3em; padding: 10px; border-radius: 5px; margin-bottom: 20px; }
        .slider-container { width: 100%; height: 40px; background: #333; position: relative; border-radius: 20px; overflow: hidden; margin-bottom: 20px; }
        .target-zone { position: absolute; height: 100%; background: rgba(0, 230, 118, 0.4); border-left: 2px solid var(--green); border-right: 2px solid var(--green); }
        .moving-cursor { position: absolute; height: 100%; width: 5px; background: white; left: 0; box-shadow: 0 0 10px white; }
        .crack-btn { width: 100%; padding: 20px; background: var(--red); color: white; font-size: 1.5em; border-radius: 10px; font-weight: bold; }

        /* --- STYLES: SCHATZSUCHE --- */
        .chest-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .chest-card { background: var(--bg-panel); padding: 20px; border-radius: 10px; border: 2px solid #555; cursor: pointer; transition: 0.2s; }
        .chest-card:hover { border-color: var(--purple); background: #2a2a2a; }
        .chest-icon { font-size: 5em; display: block; margin-bottom: 10px; }

        /* --- STYLES VOM VORG√ÑNGER (Aktien, Tycoon, Casino) --- */
        .stock-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 80vh; }
        .stock-list { overflow-y: auto; background: var(--bg-panel); padding: 10px; border-radius: 10px; }
        .tycoon-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .building-card { background: var(--bg-panel); padding: 15px; border-radius: 10px; border: 1px solid #444; position: relative; }
        .buy-btn { width: 100%; padding: 8px; margin-top: 10px; background: var(--green); color: black; border-radius: 5px; font-weight: bold; }
        .buy-btn:disabled { background: #444; color: #888; cursor: not-allowed; }

        /* Helper Klassen */
        table { width: 100%; border-collapse: collapse; }
        td, th { padding: 8px; text-align: left; border-bottom: 1px solid #333; }
        .up { color: var(--green); } .down { color: var(--red); }
    </style>
</head>
<body>

    <div id="mainMenu">
        <div class="menu-title">Business Imperium</div>
        <div class="menu-cash" id="menuCashDisplay">10.000 ‚Ç¨</div>
        
        <div class="menu-grid">
            <div class="menu-card" onclick="openGame('stocks')">
                <span class="card-icon">üìà</span>
                <div class="card-title">Aktienmarkt</div>
                <div class="card-desc">Handel & Manipulation</div>
            </div>
            <div class="menu-card" onclick="openGame('casino')">
                <span class="card-icon">üé∞</span>
                <div class="card-title">Casino</div>
                <div class="card-desc">Roulette (Rot/Schwarz)</div>
            </div>
            <div class="menu-card" onclick="openGame('tycoon')">
                <span class="card-icon">üè®</span>
                <div class="card-title">Immobilien</div>
                <div class="card-desc">Passives Einkommen</div>
            </div>

            <div class="menu-card" onclick="openGame('freelancer')">
                <span class="card-icon">üë®‚Äçüíª</span>
                <div class="card-title">Software Studio</div>
                <div class="card-desc">Klicke & Code f√ºr Geld</div>
            </div>
            <div class="menu-card" onclick="openGame('heist')">
                <span class="card-icon">üïµÔ∏è</span>
                <div class="card-title">Tresor Knacker</div>
                <div class="card-desc">Geschicklichkeit & Timing</div>
            </div>
            <div class="menu-card" onclick="openGame('loot')">
                <span class="card-icon">üè¥‚Äç‚ò†Ô∏è</span>
                <div class="card-title">Schatzsuche</div>
                <div class="card-desc">Container Auktionen</div>
            </div>
        </div>
    </div>

    <div id="view-stocks" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Wallet: <b class="cash-global"></b></span></div>
        <div class="stock-layout">
            <div class="stock-list">
                <table><tbody id="stockTableBody"></tbody></table>
            </div>
            <div style="background: var(--bg-panel); padding: 20px; border-radius: 10px; display: flex; flex-direction: column;">
                <h2 id="stockNameDisplay">Aktie w√§hlen</h2>
                <div style="flex-grow:1; position:relative;"><canvas id="stockChartCanvas"></canvas></div>
                <div style="margin-top:20px; display:flex; gap:10px;">
                    <button class="buy-btn" onclick="tradeStock('buy')" style="background:var(--green)">Kaufen</button>
                    <button class="buy-btn" onclick="tradeStock('sell')" style="background:var(--red); color:white;">Verkaufen</button>
                    <button class="buy-btn" onclick="boostStock()" style="background:var(--accent);">üöÄ BOOST</button>
                </div>
            </div>
        </div>
    </div>

    <div id="view-casino" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Chips: <b class="cash-global"></b></span></div>
        <div style="text-align: center; margin-top: 50px;">
            <div id="rouletteWheel" style="font-size: 5em; margin: 30px;">üé≤</div>
            <input type="number" id="betAmount" placeholder="Einsatz" style="padding:15px; font-size:1.2em; text-align:center; margin-bottom:20px;">
            <br>
            <button class="buy-btn" onclick="spinRoulette('red')" style="width:150px; background:var(--red); color:white;">üî¥ ROT (x2)</button>
            <button class="buy-btn" onclick="spinRoulette('black')" style="width:150px; background:#333; color:white; border:1px solid white;">‚ö´ SCHWARZ (x2)</button>
            <p id="casinoResult" style="font-size:1.5em; margin-top:20px;"></p>
        </div>
    </div>

    <div id="view-tycoon" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Konto: <b class="cash-global"></b></span></div>
        <div class="tycoon-grid" id="buildingList"></div>
    </div>

    <div id="view-freelancer" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Honorarkonto: <b class="cash-global"></b></span></div>
        
        <div class="project-card">
            <h2>Aktuelles Projekt: <span style="color:var(--blue)">Webseite entwickeln</span></h2>
            <p>Schreibe Code, um den Balken zu f√ºllen und bezahlt zu werden.</p>
            <div class="progress-container">
                <div class="progress-bar" id="codeProgress"></div>
            </div>
            <button class="code-btn" onmousedown="workCode()">‚å®Ô∏è Code tippen!</button>
        </div>
        <p style="text-align:center; color:#888;">Profi-Tipp: Klicke schnell hintereinander!</p>
    </div>

    <div id="view-heist" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Beute: <b class="cash-global"></b></span></div>
        
        <div style="text-align: center; margin-top: 40px;">
            <h1>Der Million√§rs-Safe</h1>
            <p>Stoppe den Cursor genau im gr√ºnen Bereich. <br>Kosten pro Versuch: 500 ‚Ç¨</p>
            
            <div class="safe-box">
                <div class="safe-display" id="heistStatus">LOCKED</div>
                <div class="slider-container">
                    <div id="heistTarget" class="target-zone" style="left: 40%; width: 20%;"></div>
                    <div id="heistCursor" class="moving-cursor"></div>
                </div>
                <button class="crack-btn" id="heistBtn" onclick="attemptHeist()">üîì JETZT KNACKEN</button>
            </div>
        </div>
    </div>

    <div id="view-loot" class="game-view">
        <div class="top-bar"><button class="back-btn" onclick="goHome()">üè† Zur√ºck</button><span>Kasse: <b class="cash-global"></b></span></div>
        
        <h1 style="text-align:center; color:var(--purple);">Lagerraum Auktionen</h1>
        <p style="text-align:center;">Kaufe einen ungesehenen Container. Ist Gold drin oder alter M√ºll?</p>
        <br>
        
        <div class="chest-grid">
            <div class="chest-card" onclick="openLoot(100)">
                <span class="chest-icon">üì¶</span>
                <h3>Kleiner Karton</h3>
                <p>Preis: 100 ‚Ç¨</p>
                <p style="font-size:0.8em; color:#888;">M√∂gliche Werte: 0 ‚Ç¨ - 500 ‚Ç¨</p>
            </div>
            <div class="chest-card" onclick="openLoot(1000)">
                <span class="chest-icon">üöö</span>
                <h3>Transporter</h3>
                <p>Preis: 1.000 ‚Ç¨</p>
                <p style="font-size:0.8em; color:#888;">M√∂gliche Werte: 100 ‚Ç¨ - 5.000 ‚Ç¨</p>
            </div>
            <div class="chest-card" onclick="openLoot(5000)">
                <span class="chest-icon">üö¢</span>
                <h3>Schiffs-Container</h3>
                <p>Preis: 5.000 ‚Ç¨</p>
                <p style="font-size:0.8em; color:#888;">M√∂gliche Werte: 0 ‚Ç¨ - 50.000 ‚Ç¨</p>
            </div>
        </div>
        <div id="lootResult" style="text-align:center; font-size:2em; font-weight:bold; margin-top:30px; height: 50px;"></div>
    </div>


    <script>
        // --- GLOBALS ---
        let cash = 10000;

        // --- CORE SYSTEM ---
        function formatMoney(n) { return n.toLocaleString('de-DE', {style:'currency', currency:'EUR'}); }
        
        function updateAllUI() {
            document.getElementById('menuCashDisplay').innerText = formatMoney(cash);
            document.querySelectorAll('.cash-global').forEach(el => el.innerText = formatMoney(cash));
            renderTycoon(); // Buttons aktualisieren
        }

        function openGame(id) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('view-'+id).style.display = 'block';
            
            // Spezielle Init Logik f√ºr Heist
            if(id === 'heist') startHeistAnim();
            
            updateAllUI();
        }

        function goHome() {
            document.querySelectorAll('.game-view').forEach(el => el.style.display = 'none');
            document.getElementById('mainMenu').style.display = 'flex';
            stopHeistAnim(); // Heist anhalten um CPU zu sparen
            updateAllUI();
        }

        // --- 1. FREELANCER LOGIK ---
        let projectProgress = 0;
        function workCode() {
            projectProgress += 5; // 5% pro Klick
            if(projectProgress >= 100) {
                projectProgress = 0;
                let pay = 300 + Math.floor(Math.random() * 200); // 300-500‚Ç¨
                cash += pay;
                updateAllUI();
                // Kleiner Effekt
                let btn = document.querySelector('.code-btn');
                btn.innerText = `+ ${pay} ‚Ç¨ VERDIENT!`;
                setTimeout(() => btn.innerText = "‚å®Ô∏è Code tippen!", 1000);
            }
            document.getElementById('codeProgress').style.width = projectProgress + "%";
        }

        // --- 2. HEIST LOGIK ---
        let heistInterval = null;
        let cursorPos = 0;
        let direction = 1;
        let targetStart = 40;
        let targetWidth = 20;

        function startHeistAnim() {
            if(heistInterval) clearInterval(heistInterval);
            // Neues Ziel setzen
            targetWidth = 10 + Math.random() * 20; // Breite zwischen 10% und 30%
            targetStart = Math.random() * (100 - targetWidth);
            document.getElementById('heistTarget').style.left = targetStart + "%";
            document.getElementById('heistTarget').style.width = targetWidth + "%";
            document.getElementById('heistStatus').innerText = "LOCKED";
            document.getElementById('heistStatus').style.color = "red";

            // Animation Loop
            heistInterval = setInterval(() => {
                cursorPos += 1.5 * direction; // Geschwindigkeit
                if(cursorPos >= 100 || cursorPos <= 0) direction *= -1;
                document.getElementById('heistCursor').style.left = cursorPos + "%";
            }, 10); // 100fps
        }

        function stopHeistAnim() { clearInterval(heistInterval); }

        function attemptHeist() {
            if(cash < 500) { alert("Du brauchst 500 ‚Ç¨ f√ºr das Werkzeug!"); return; }
            cash -= 500;
            
            // Pr√ºfen ob getroffen
            if(cursorPos >= targetStart && cursorPos <= (targetStart + targetWidth)) {
                let loot = 2000 + Math.floor(Math.random() * 5000);
                cash += loot;
                document.getElementById('heistStatus').innerText = "OPEN: +" + loot + "‚Ç¨";
                document.getElementById('heistStatus').style.color = "lime";
            } else {
                document.getElementById('heistStatus').innerText = "ALARM! (-500‚Ç¨)";
            }
            updateAllUI();
        }

        // --- 3. LOOTBOX LOGIK ---
        function openLoot(cost) {
            if(cash < cost) { alert("Zu wenig Geld!"); return; }
            cash -= cost;
            
            let resultEl = document.getElementById('lootResult');
            resultEl.innerText = "√ñffne...";
            resultEl.style.color = "white";

            setTimeout(() => {
                // Multiplikator zwischen 0x und 5x (Gewichtet nach unten)
                let luck = Math.random();
                let multi = 0;
                
                if(luck > 0.9) multi = 5;       // Jackpot (10% Chance)
                else if(luck > 0.6) multi = 1.5; // Kleiner Gewinn
                else if(luck > 0.3) multi = 0.5; // Verlust
                else multi = 0;                  // Niete (M√ºll)

                let win = Math.floor(cost * multi);
                cash += win;
                
                if(win > cost) {
                    resultEl.innerText = "JACKPOT! " + formatMoney(win);
                    resultEl.style.color = "var(--accent)";
                } else if(win === 0) {
                    resultEl.innerText = "Nur M√ºll drin... (0 ‚Ç¨)";
                    resultEl.style.color = "var(--red)";
                } else {
                    resultEl.innerText = "Wert: " + formatMoney(win);
                    resultEl.style.color = "white";
                }
                updateAllUI();
            }, 800);
        }

        // --- ALT: AKTIEN (Mini Version) ---
        let stocks = [{id:0, name:"TechCorp", price:100, owned:0, hist:[100]}, {id:1, name:"BananaInc", price:50, owned:0, hist:[50]}];
        let stockChart; 
        
        function initStocks() {
             const ctx = document.getElementById('stockChartCanvas').getContext('2d');
             stockChart = new Chart(ctx, { type:'line', data:{labels:[], datasets:[{data:[], borderColor:'#00e676', tension:0.1}]}, options:{responsive:true, maintainAspectRatio:false, plugins:{legend:false}, scales:{x:{display:false}}} });
             setInterval(() => {
                 stocks.forEach(s => { 
                     s.price = Math.max(1, s.price + (Math.random()-0.5)*5); 
                     if(s.hist.length > 20) s.hist.shift();
                     s.hist.push(s.price);
                 });
                 renderStocks();
             }, 1000);
        }
        function renderStocks() {
            let html = "";
            stocks.forEach(s => html += `<tr><td>${s.name}</td><td>${formatMoney(s.price)}</td><td>${s.owned}</td><td><button onclick="tradeS(${s.id}, 1)">K</button> <button onclick="tradeS(${s.id}, -1)">V</button></td></tr>`);
            document.getElementById('stockTableBody').innerHTML = html;
            if(stocks[0]) { 
                stockChart.data.datasets[0].data = stocks[0].hist; 
                stockChart.update(); 
            }
        }
        function tradeS(id, amount) {
            let s = stocks[id];
            if(amount > 0 && cash >= s.price) { cash-=s.price; s.owned++; }
            if(amount < 0 && s.owned > 0) { cash+=s.price; s.owned--; }
            updateAllUI();
        }

        // --- ALT: TYCOON ---
        let builds = [{id:0, name:"Kiosk", cost:100, inc:2, count:0}, {id:1, name:"Fabrik", cost:1000, inc:25, count:0}];
        function renderTycoon() {
            let div = document.getElementById('buildingList'); div.innerHTML="";
            builds.forEach(b => {
                let cost = Math.floor(b.cost * Math.pow(1.1, b.count));
                div.innerHTML += `<div class="building-card"><h3>${b.name} (${b.count})</h3><div style="color:lime">+${b.inc}‚Ç¨/s</div><button class="buy-btn" onclick="buyB(${b.id})" ${cash<cost?'disabled':''}>Kaufen ${cost}‚Ç¨</button></div>`;
            });
        }
        function buyB(id) {
            let b = builds[id]; let cost = Math.floor(b.cost * Math.pow(1.1, b.count));
            if(cash>=cost) { cash-=cost; b.count++; updateAllUI(); renderTycoon(); }
        }
        setInterval(() => {
            let sum = 0; builds.forEach(b=>sum+=b.count*b.inc);
            if(sum>0) { cash+=sum; updateAllUI(); }
        }, 1000);

        // --- ALT: CASINO ---
        function spinRoulette(col) {
            let bet = parseInt(document.getElementById('betAmount').value);
            if(!bet || bet>cash) return alert("Ung√ºltig");
            cash-=bet; updateAllUI();
            let res = Math.random()>0.5 ? 'red' : 'black';
            if(col===res) cash += bet*2;
            document.getElementById('casinoResult').innerText = col===res ? "GEWONNEN!" : "VERLOREN";
            updateAllUI();
        }

        // START
        initStocks();
        updateAllUI();

    </script>
</body>
</html>
