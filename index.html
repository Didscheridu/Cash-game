<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Imperium: Ultimate</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-panel: #1e1e1e;
            --accent: #FFD700; /* Gold */
            --green: #00e676;
            --red: #ff5252;
            --blue: #2979ff;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-dark);
            color: white;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        /* --- HAUPTMEN√ú --- */
        #mainMenu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: radial-gradient(circle, #2c2c2c 0%, #000000 100%);
        }
        .menu-title { font-size: 4em; margin-bottom: 20px; color: var(--accent); text-transform: uppercase; letter-spacing: 5px; }
        .menu-cash { font-size: 2em; margin-bottom: 50px; color: var(--green); }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            max-width: 1000px;
            width: 100%;
            padding: 20px;
        }
        .menu-card {
            background: var(--bg-panel);
            padding: 40px;
            border-radius: 15px;
            border: 2px solid #333;
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s;
        }
        .menu-card:hover { transform: translateY(-10px); border-color: var(--accent); }
        .card-icon { font-size: 4em; display: block; margin-bottom: 20px; }
        .card-title { font-size: 1.5em; font-weight: bold; }
        .card-desc { color: #888; margin-top: 10px; }

        /* --- GAME VIEWS ALLGEMEIN --- */
        .game-view { display: none; height: 100vh; box-sizing: border-box; padding: 20px; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; background: #333; padding: 10px 20px; border-radius: 10px; margin-bottom: 20px; }
        .back-btn { background: #555; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .back-btn:hover { background: #777; }

        /* --- STYLES F√úR AKTIEN (Aus v5) --- */
        .stock-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 85vh; }
        .stock-list { overflow-y: auto; background: var(--bg-panel); padding: 10px; border-radius: 10px; }
        .stock-chart { background: var(--bg-panel); padding: 20px; border-radius: 10px; display: flex; flex-direction: column; }
        table { width: 100%; border-collapse: collapse; }
        td, th { padding: 10px; text-align: left; border-bottom: 1px solid #333; }
        tr:hover { background: #333; cursor: pointer; }
        .up { color: var(--green); } .down { color: var(--red); } .boost { color: var(--accent); }

        /* --- STYLES F√úR CASINO --- */
        .casino-center { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 80vh; }
        .roulette-wheel { 
            width: 200px; height: 200px; border-radius: 50%; border: 10px solid #fff; 
            margin: 30px; display: flex; align-items: center; justify-content: center; font-size: 3em; font-weight: bold;
            background: #333; transition: transform 0.5s;
        }
        .bet-btn { padding: 15px 30px; margin: 10px; font-size: 1.2em; border: none; border-radius: 5px; cursor: pointer; color: white; font-weight: bold; }
        .btn-red { background: var(--red); }
        .btn-black { background: #333; border: 1px solid white; }
        .btn-green { background: var(--green); }

        /* --- STYLES F√úR TYCOON (IMMOBILIEN) --- */
        .tycoon-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .building-card { background: var(--bg-panel); padding: 20px; border-radius: 10px; text-align: left; border: 1px solid #444; position: relative; overflow: hidden; }
        .building-img { font-size: 3em; float: right; opacity: 0.3; }
        .income-tag { color: var(--green); font-weight: bold; }
        .buy-btn { width: 100%; padding: 10px; margin-top: 10px; background: var(--blue); color: white; border: none; border-radius: 5px; cursor: pointer; }
        .buy-btn:disabled { background: #444; cursor: not-allowed; }

    </style>
</head>
<body>

    <div id="mainMenu">
        <div class="menu-title">Business Imperium</div>
        <div class="menu-cash">Kontostand: <span id="menuCashDisplay">10.000 ‚Ç¨</span></div>
        
        <div class="menu-grid">
            <div class="menu-card" onclick="openGame('stocks')">
                <span class="card-icon">üìà</span>
                <div class="card-title">Wall Street</div>
                <div class="card-desc">Handel mit volatilen Aktien. Hohes Risiko, Charts und Marktmanipulation.</div>
            </div>

            <div class="menu-card" onclick="openGame('casino')">
                <span class="card-icon">üé∞</span>
                <div class="card-title">High Roller Casino</div>
                <div class="card-desc">Roulette & Gl√ºcksspiel. Verdopple dein Geld oder verliere alles in Sekunden.</div>
            </div>

            <div class="menu-card" onclick="openGame('tycoon')">
                <span class="card-icon">üè®</span>
                <div class="card-title">Immobilien Mogul</div>
                <div class="card-desc">Kaufe Geb√§ude und kassiere Miete. Baue ein Imperium auf, das dir geh√∂rt.</div>
            </div>
        </div>
    </div>

    <div id="view-stocks" class="game-view">
        <div class="top-bar">
            <button class="back-btn" onclick="goHome()">üè† Zur√ºck zum Men√º</button>
            <div>B√∂rsen-Wallet: <span class="cash-global" style="color:var(--green); font-weight:bold;"></span></div>
        </div>
        <div class="stock-layout">
            <div class="stock-list">
                <table>
                    <thead><tr><th>Aktie</th><th>Preis</th><th>Besitz</th></tr></thead>
                    <tbody id="stockTableBody"></tbody>
                </table>
            </div>
            <div class="stock-chart">
                <h2 id="stockNameDisplay">W√§hle eine Aktie</h2>
                <div style="flex-grow:1; position:relative;"><canvas id="stockChartCanvas"></canvas></div>
                <div style="margin-top:20px; display:flex; gap:10px;">
                    <button class="buy-btn" onclick="tradeStock('buy')" style="background:var(--green)">Kaufen</button>
                    <button class="buy-btn" onclick="tradeStock('sell')" style="background:var(--red)">Verkaufen</button>
                    <button class="buy-btn" id="boostBtn" onclick="boostStock()" style="background:var(--accent); color:black;">üöÄ BOOST (10x)</button>
                </div>
            </div>
        </div>
    </div>

    <div id="view-casino" class="game-view">
        <div class="top-bar">
            <button class="back-btn" onclick="goHome()">üè† Zur√ºck zum Men√º</button>
            <div>Casino Chips: <span class="cash-global" style="color:var(--green); font-weight:bold;"></span></div>
        </div>
        <div class="casino-center">
            <h1>Roulette: Rot oder Schwarz?</h1>
            <div id="rouletteWheel" class="roulette-wheel">?</div>
            <input type="number" id="betAmount" placeholder="Einsatz" style="padding:10px; font-size:1.2em; text-align:center; width:200px; margin-bottom:20px;">
            <div>
                <button class="bet-btn btn-red" onclick="spinRoulette('red')">üî¥ ROT (x2)</button>
                <button class="bet-btn btn-black" onclick="spinRoulette('black')">‚ö´ SCHWARZ (x2)</button>
                <button class="bet-btn btn-green" onclick="spinRoulette('green')">üü¢ GR√úN (x14)</button>
            </div>
            <p id="casinoResult" style="margin-top:20px; font-size:1.5em;"></p>
        </div>
    </div>

    <div id="view-tycoon" class="game-view">
        <div class="top-bar">
            <button class="back-btn" onclick="goHome()">üè† Zur√ºck zum Men√º</button>
            <div>Immobilien-Konto: <span class="cash-global" style="color:var(--green); font-weight:bold;"></span> | Einkommen: <span id="passiveIncomeDisplay">0 ‚Ç¨</span>/sek</div>
        </div>
        <div class="tycoon-grid" id="buildingList">
            </div>
    </div>

    <script>
        // --- GLOBALE VARIABLEN ---
        let cash = 10000;
        
        // Update alle Geldanzeigen auf der Seite
        function updateCashDisplay() {
            document.getElementById('menuCashDisplay').innerText = formatMoney(cash);
            let displays = document.getElementsByClassName('cash-global');
            for(let d of displays) d.innerText = formatMoney(cash);
            
            // Tycoon Buttons checken
            renderTycoon(); 
        }

        function formatMoney(num) {
            return num.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' });
        }

        // --- NAVIGATION ---
        function openGame(gameId) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('view-' + gameId).style.display = 'block';
            updateCashDisplay();
        }

        function goHome() {
            document.querySelectorAll('.game-view').forEach(el => el.style.display = 'none');
            document.getElementById('mainMenu').style.display = 'flex';
            updateCashDisplay();
        }

        // ==========================================
        // SPIEL 1 LOGIK: AKTIEN (Vereinfacht f√ºr √úbersicht)
        // ==========================================
        let stocks = [];
        let selectedStockId = null;
        let chartInstance = null;

        // Init Stocks
        for(let i=0; i<20; i++) {
            stocks.push({ 
                id: i, 
                name: "Firma " + String.fromCharCode(65+i), 
                price: Math.random()*100+10, 
                owned: 0, 
                history: Array(50).fill(0),
                boost: 0 
            });
        }

        function initChart() {
            const ctx = document.getElementById('stockChartCanvas').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: { labels: Array(50).fill(''), datasets: [{ label: 'Kurs', data: [], borderColor: '#00e676', tension: 0.1 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: {legend: {display:false}}, scales: {x:{display:false}} }
            });
        }
        initChart();

        // Markt Simulation Loop
        setInterval(() => {
            stocks.forEach(s => {
                if(s.boost > 0) {
                    s.price *= 1.1; // 10% pro Tick hoch bei Boost
                    s.boost--;
                } else {
                    let change = (Math.random() - 0.5) * 4; 
                    s.price += change;
                    if(s.price < 1) s.price = 1;
                }
                s.history.shift();
                s.history.push(s.price);
            });
            renderStocks();
            if(selectedStockId !== null) updateChart();
        }, 1000);

        function renderStocks() {
            let html = '';
            stocks.forEach(s => {
                let style = (selectedStockId === s.id) ? 'background:#333' : '';
                html += `<tr onclick="selectStock(${s.id})" style="${style}"><td>${s.name}</td><td>${formatMoney(s.price)}</td><td>${s.owned}</td></tr>`;
            });
            document.getElementById('stockTableBody').innerHTML = html;
        }

        function selectStock(id) {
            selectedStockId = id;
            document.getElementById('stockNameDisplay').innerText = stocks[id].name;
            updateChart();
            renderStocks();
        }

        function updateChart() {
            let s = stocks[selectedStockId];
            chartInstance.data.datasets[0].data = s.history;
            chartInstance.data.datasets[0].borderColor = s.boost > 0 ? '#FFD700' : '#00e676';
            chartInstance.update();
        }

        function tradeStock(type) {
            if(selectedStockId === null) return;
            let s = stocks[selectedStockId];
            if(type === 'buy') {
                if(cash >= s.price) { cash -= s.price; s.owned++; }
            } else {
                if(s.owned > 0) { cash += s.price; s.owned--; }
            }
            updateCashDisplay();
            renderStocks();
        }

        function boostStock() {
            if(selectedStockId !== null) stocks[selectedStockId].boost = 15; // 15 Ticks Boost
        }


        // ==========================================
        // SPIEL 2 LOGIK: CASINO (Roulette)
        // ==========================================
        function spinRoulette(choice) {
            let input = document.getElementById('betAmount');
            let bet = parseInt(input.value);
            if(!bet || bet <= 0 || bet > cash) { alert("Ung√ºltiger Einsatz!"); return; }

            cash -= bet;
            updateCashDisplay();

            let wheel = document.getElementById('rouletteWheel');
            wheel.style.transform = "rotate(1080deg)"; // Animation Fake
            wheel.innerText = "üé≤";

            setTimeout(() => {
                wheel.style.transform = "rotate(0deg)";
                let rand = Math.random();
                let resultColor = 'black';
                if(rand < 0.05) resultColor = 'green'; // 5% Chance auf Gr√ºn
                else if(rand < 0.525) resultColor = 'red'; // ca 47.5% Rot

                wheel.style.background = resultColor === 'red' ? 'var(--red)' : (resultColor === 'green' ? 'var(--green)' : '#333');
                wheel.innerText = resultColor === 'red' ? 'üî¥' : (resultColor === 'green' ? 'üü¢' : '‚ö´');

                let win = 0;
                if(choice === resultColor) {
                    if(choice === 'green') win = bet * 14;
                    else win = bet * 2;
                }

                if(win > 0) {
                    cash += win;
                    document.getElementById('casinoResult').innerText = "GEWONNEN: " + formatMoney(win);
                    document.getElementById('casinoResult').style.color = "var(--green)";
                } else {
                    document.getElementById('casinoResult').innerText = "VERLOREN";
                    document.getElementById('casinoResult').style.color = "var(--red)";
                }
                updateCashDisplay();
            }, 1000);
        }


        // ==========================================
        // SPIEL 3 LOGIK: TYCOON (Immobilien)
        // ==========================================
        let buildings = [
            { id: 0, name: "Kiosk", cost: 100, income: 1, count: 0, icon: "üè™" },
            { id: 1, name: "Wohnung", cost: 1500, income: 10, count: 0, icon: "üè†" },
            { id: 2, name: "Supermarkt", cost: 10000, income: 80, count: 0, icon: "üõí" },
            { id: 3, name: "Fabrik", cost: 50000, income: 450, count: 0, icon: "üè≠" },
            { id: 4, name: "Wolkenkratzer", cost: 250000, income: 2500, count: 0, icon: "üåá" }
        ];

        function renderTycoon() {
            let container = document.getElementById('buildingList');
            container.innerHTML = "";
            let totalIncome = 0;

            buildings.forEach(b => {
                totalIncome += b.count * b.income;
                let currentCost = Math.floor(b.cost * Math.pow(1.15, b.count)); // Preis steigt um 15% pro Kauf

                let btnDisabled = cash < currentCost ? "disabled" : "";

                let html = `
                <div class="building-card">
                    <span class="building-img">${b.icon}</span>
                    <h3>${b.name}</h3>
                    <div class="income-tag">+${b.income} ‚Ç¨ / sek</div>
                    <div>Besitz: ${b.count}</div>
                    <button class="buy-btn" onclick="buyBuilding(${b.id})" ${btnDisabled}>
                        Kaufen (${formatMoney(currentCost)})
                    </button>
                </div>`;
                container.innerHTML += html;
            });
            document.getElementById('passiveIncomeDisplay').innerText = totalIncome;
        }

        function buyBuilding(id) {
            let b = buildings[id];
            let currentCost = Math.floor(b.cost * Math.pow(1.15, b.count));
            if(cash >= currentCost) {
                cash -= currentCost;
                b.count++;
                updateCashDisplay();
                renderTycoon();
            }
        }

        // Passives Einkommen Timer (Jede Sekunde)
        setInterval(() => {
            let income = 0;
            buildings.forEach(b => { income += b.count * b.income; });
            if(income > 0) {
                cash += income;
                // Nur UI updaten wenn wir im Tycoon Men√º oder Hauptmen√º sind, um Performance zu sparen
                if(document.getElementById('view-tycoon').style.display === 'block' || 
                   document.getElementById('mainMenu').style.display === 'flex') {
                    updateCashDisplay();
                }
            }
        }, 1000);

        // Start
        updateCashDisplay();

    </script>
</body>
</html>
